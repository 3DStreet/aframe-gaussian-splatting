{"version":3,"sources":["./index.js"],"names":["AFRAME","registerComponent","schema","src","type","default","init","this","el","sceneEl","renderer","setPixelRatio","fetch","data","then","blob","res","arrayBuffer","let","size","THREE","Vector2","getSize","renderTarget_gs","WebGLRenderTarget","x","y","minFilter","NearestFilter","magFilter","renderTarget_camera","depthTexture","DepthTexture","focal","Math","tan","camera","components","fov","PI","geometry","PlaneGeometry","material","ShaderMaterial","uniforms","viewport","value","Float32Array","cameraDepth","vertexShader","fragmentShader","blending","CustomBlending","blendEquation","AddEquation","blendSrc","OneMinusDstAlphaFactor","blendDst","OneFactor","blendSrcAlpha","blendDstAlpha","depthTest","needsUpdate","window","addEventListener","setSize","vertexCount","floor","buffer","byteLength","f_buffer","u_buffer","Uint8Array","matrices","i","quat","Quaternion","center","Vector3","scale","mtx","Matrix4","mtx_t","makeRotationFromQuaternion","transpose","clone","premultiply","setPosition","elements","j","camera_mtx","object3D","matrixWorld","view","iMesh","InstancedMesh","frustumCulled","instanceMatrix","array","sortSplats","visible","add","composed_screen","Mesh","cameraTexture","texture","gsTexture","onBeforeRender","render_skip","setRenderTarget","render","worker","Worker","URL","createObjectURL","Blob","createWorker","toString","postMessage","sortFunction","onmessage","e","sortedMatrices","sortReady","tick","time","timeDelta","self","eval","length","maxDepth","Infinity","minDepth","depthList","sizeList","Int32Array","depth","depthInv","counts0","Uint32Array","starts0","depthIndex","k"],"mappings":"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"}